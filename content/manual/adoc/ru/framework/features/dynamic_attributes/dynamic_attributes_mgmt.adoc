:sourcesdir: ../../../../../source

[[dynamic_attributes_mgmt]]
===== Управление динамическими атрибутами

Управление категориями и описаниями атрибутов осуществляется с помощью специальных экранов, доступных через меню *Administration → Dynamic Attributes*.

.Экран списка категорий
image::categoryBrowser.png[align="center"]

Редактор категорий позволяет создать категорию для выбранного типа сущности и добавить в нее набор динамических атрибутов. Для категории обязательно указывается имя и соответствующий тип сущности. Флажок *Default* указывает, что данная категория будет автоматически выбрана для нового экземпляра сущности, реализующей интерфейс `Categorized`.

.Экран редактирования категории
image::categoryEditor.png[align="center"]

Секция *Name localization* отображается, если приложение поддерживает более одного языка, и позволяет задать локализованное значение имени категории для каждой доступной локали.

.Локализация имени категории
image::categoryLocalization.png[align="center"]

[[dynamic_attributes_mgmt_attr_location]]
На вкладке *Attributes Location* вы можете настроить расположение каждого динамического атрибута внутри <<categorized_entity,DynamicAttributesPanel>>.

.Настройка расположения атрибутов
image::dynamic_attributes_location.png[align="center"]

Укажите количество колонок в выпадающем списке *Columns count*. Перетащите атрибут из списка атрибутов в нужный столбец и нужную строку. Вы можете добавлять пустые ячейки и менять порядок отображения атрибутов. После внесения изменений нажмите на кнопку *Save configuration*.

Расположение атрибутов на панели `DynamicAttributesPanel` в редакторе сущности:

image::dynamic_attributes_location_rezult.png[align="center"]

Редактор динамического атрибута позволяет задать имя, системный код, тип значения и значение атрибута по умолчанию.

.Редактор динамического атрибута
image::runtimePropertyEditor.png[align="center"]

Для всех типов значения, кроме `Boolean`, доступно поле *Width*, позволяющее задать ширину поля в `FieldGroup` в пикселах или процентах. Если поле *Width* не заполнено, его значение по умолчанию равно 100%.

Для всех типов значения, кроме `Boolean` и `Enumeration`, также доступен чекбокс *Is* *collection*. Он позволяет создавать динамические атрибуты выбранного типа со множеством значений.

Для всех типов значения поддерживается локализация имени атрибута:

.Локализация динамического атрибута
image::runtimePropertyLocalization.png[align="center"]

Если выбран тип значения `Enumeration`, множество значений перечисления задаётся в поле *Enumeration* в редакторе списка.

.Редактор динамического атрибута для типа значений `Enumeration`
image::runtimePropertyEnum.png[align="center"]

Каждое значение перечисления также может быть локализовано на языки, доступные в приложении:

.Локализация динамического атрибута для типа значений `Enumeration`
image::runtimePropertyEnumLocalization.png[align="center"]

Динамический атрибут также имеет настройки видимости, описывающие, на каких экранах его нужно отображать. По умолчанию атрибут не отображается нигде.

.Настройки видимости динамического атрибута
image::runtimePropertyVisibility.png[align="center"]

Кроме экрана можно также указать компонент, в котором атрибут должен появляться (например, для экранов, где несколько компонентов <<gui_FieldGroup,FieldGroup>> показывают поля одной и той же сущности).

Если атрибут отмечен как видимый на каком-либо экране, он автоматически отобразится во всех группах полей и таблицах, отображающих объекты данного типа в данном экране.

Доступ к динамическим атрибутам также может быть ограничен через настройки в <<roles,ролях пользователей>>. Настройки осуществляются так же, как для обычных атрибутов.

Для того чтобы изменения в атрибутах и настройках видимости вступили в силу, необходимо нажать кнопку *Применить изменения* на экране со списком категорий. Изменения также можно применить через *Administration → JMX Console*, вызвав метод `clearDynamicAttributesCache()` JMX бина `app-core.cuba:type=CachingFacade`.

Ниже изображен динамический атрибут, добавленный в экран автоматически путем задания настроек отображения атрибута:

image::runtimePropsApplyChanges.png[align="center"]

Динамические атрибуты можно добавить в экран вручную. Для этого необходимо выполнить следующее:

* В секции `dsContext` XML-дескриптора экрана для источника данных с загружаемой сущностью (сущностями) установить в `true` признак `loadDynamicAttributes` для источника данных с загружаемой сущностью (сущностями), например:
+
[source, xml]
----
<dsContext>
  <datasource id="carDs" class="com.company.sample.entity.Car" view="_local" loadDynamicAttributes="true"/>
</dsContext>
----

* В описании визуального компонента в качестве `property` нужно использовать код динамического атрибута с префиксом `+++++`:
+
[source, xml]
----
<textField id="numberOfSeats" datasource="carDs" property="+numberOfSeats"/>
----

